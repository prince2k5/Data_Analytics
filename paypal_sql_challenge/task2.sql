-- ðŒðžð«ðœð¡ðšð§ð­ ð‘ðžð¯ðžð§ð®ðž ð€ð§ðšð¥ð²ð¬ð¢ð¬ ðŸ’­ Problem: A table contains: MerchantID, TransactionAmount, TransactionDate, Country.

-- Task 2: Write a query to calculate the ð­ð¨ð­ðšð¥ ð«ðžð¯ðžð§ð®ðž generated by each merchant over the ð¥ðšð¬ð­ ðªð®ðšð«ð­ðžð«, grouped by ðœð¨ð®ð§ð­ð«ð².

SELECT
    MerchantID,
    Country,
    SUM(TransactionAmount) AS TotalRevenue
FROM Transactions
WHERE TransactionDate >= DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months'
  AND TransactionDate < DATE_TRUNC('quarter', CURRENT_DATE)
GROUP BY MerchantID, Country
ORDER BY Country, TotalRevenue DESC;

